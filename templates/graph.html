<html lang="en">
  <head>
    <title>graph testing</title>

    <script
      type="text/javascript"
      src="https://visjs.github.io/vis-network/standalone/umd/vis-network.min.js"
    ></script>

    <style type="text/css">
      #mynetwork {
        width: 100%;
        height: 100%;
        border: 1px solid lightgray;
      }
    </style>
  </head>
  <script type="text/javascript">
      function draw() {
var container = document.getElementById("mynetwork");
var books = {{books|tojson|safe}};
var influences = {{influences|tojson|safe}};
var nodelist = [];
for (let i= 0; i < books.length; i++) {
    nodelist.push({
        'id': books[i]['id'],
        'shape': "circularImage",
        'image': books[i]['image'],
        'label': books[i]['name'],
        'fixed': false,
        'url': 'text/' + books[i]['name']
    });
}
var edgelist = [];
for (let j= 0; j < influences.length; j++) {
    edgelist.push(
        {'from': influences[j]['r.start'][0], 'to': influences[j]['r.end'][0]}
    );
}

  var nodes = new vis.DataSet(nodelist);
  var edges = new vis.DataSet(edgelist);
  var data = {
    nodes: nodes,
    edges: edges
  };

  var options = {
    nodes: {
      borderWidth: 0,
      size: 42,
      color: {
        border: "#222",
        background: "transparent"
      },
      font: {
        color: "#111",
        face: "Helvetic",
        size: 16,
        strokeWidth: 1,
        strokeColor: "#222"
      }
    },
    edges: {
      color: {
        color: "#CCC",
        highlight: "#A22"
      },
      width: 5,
      length: 350,
      hoverWidth: 0.05
    }
  };

  var network = new vis.Network(container, data, options);
  network.on("selectNode", function (params) {
    if (params.nodes.length === 1) {
      var node = nodes.get(params.nodes[0]);
      window.open(node.url, "_blank");
    }
    network.unselectAll();
  });
}

  </script>
  <body onload="draw()">
    <div id="mynetwork"></div>
  </body>
</html>